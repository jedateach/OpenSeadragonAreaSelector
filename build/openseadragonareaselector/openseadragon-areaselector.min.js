//! OpenSeadragonAreaSelector 0.1.0
//! Build date: 2015-04-09
//! https://github.com/jedateach/OpenSeadragonAreaSelector
!function(a){function b(){var a=document.createElement("div");return a.className="openseadragon-areaselector",a.style.cursor="move",a.style.position="relative",a.style.border="2px dashed #2CFC0E",a}function c(a){a.handles=a.heandles||{};var b="-7px",c="10px",d={n:{w:c,h:c,t:b,l:"50%",c:"ns"},e:{w:c,h:c,t:"50%",r:b,c:"ew"},s:{w:c,h:c,b:b,r:"50%",c:"ns"},w:{w:c,h:c,b:"50%",l:b,c:"ew"},se:{w:c,h:c,b:b,r:b,c:"nwse"},sw:{w:c,h:c,b:b,l:b,c:"nesw"},ne:{w:c,h:c,t:b,r:b,c:"nesw"},nw:{w:c,h:c,t:b,l:b,c:"nwse"}};for(var e in d){var f=document.createElement("div"),g=e+"-resize";f.className="openseadragon-areaselector-handle handle-"+g,f.style.position="absolute",f.style.width=d[e].w,f.style.height=d[e].h,void 0!==d[e].t&&(f.style.top=d[e].t),void 0!==d[e].b&&(f.style.bottom=d[e].b),void 0!==d[e].l&&(f.style.left=d[e].l),void 0!==d[e].r&&(f.style.right=d[e].r),f.style.cursor=d[e].c+"-resize",f.style.backgroundColor="#2CFC0E",f.style.borderRadius="50%",a.element.appendChild(f)}}a.AreaSelector=function(d){if(this.options=d||{},!d.viewer)throw new Error("A viewer must be specified.");this.viewer=d.viewer,this.element=b(),c(this),this.rect=new a.Rect(.45,.45,.1,.1),this.viewer.addOverlay(this.element,this.rect,a.OverlayPlacement.CENTER),this.mouseTracker=new a.MouseTracker({element:this.element,pressHandler:a.delegate(this,this.pressHandler),dragHandler:a.delegate(this,this.dragHandler),dragEndHandler:a.delegate(this,this.dragEndHandler)}),this.gridSize=.1,this.boundary=this.options.boundary||this.viewer.viewport.getBounds()},a.AreaSelector.prototype={pressHandler:function(a){this.dragStartOffset=this.viewer.viewport.deltaPointsFromPixels(a.position)},dragHandler:function(b){var c=this.viewer.viewport.pointFromPixel(new a.Point(b.originalEvent.x,b.originalEvent.y));this.rect.x=c.x-this.dragStartOffset.x,this.rect.y=c.y-this.dragStartOffset.y,this.respectBoundary(),this.viewer.updateOverlay(this.element,this.rect,a.OverlayPlacement.TOP_LEFT)},dragEndHandler:function(){},snapToGrid:function(){this.rect.x=Math.floor(10*this.rect.x)/10,this.rect.y=Math.floor(10*this.rect.y)/10},respectBoundary:function(){if(this.boundary){var a=this.boundary;this.rect.x<a.x?this.rect.x=a.x:this.rect.x+this.rect.width>a.x+a.width&&(this.rect.x=a.x+a.width-this.rect.width),this.rect.y<a.y?this.rect.y=a.y:this.rect.y+this.rect.height>a.y+a.height&&(this.rect.y=a.y+a.height-this.rect.height)}}},a.Viewer.prototype.activateAreaSelector=function(b){return this.areaSelector||(b=b||{},b.viewer=this,this.areaSelector=new a.AreaSelector(b)),this.areaSelector}}(OpenSeadragon);